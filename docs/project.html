<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Job Seeker Insights and Recommendations – AI vs.&nbsp;Non-AI Job Growth</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-66ab7fd5e73b7f0a764e0d49b3e29ab1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-aab37fff69bc8184003ffd2db61e847e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">AI vs.&nbsp;Non-AI Job Growth</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./findings.html"> 
<span class="menu-text">Findings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./career_strategy.html"> 
<span class="menu-text">Career Strategy</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#job-seeker-insights-and-recommendations" id="toc-job-seeker-insights-and-recommendations" class="nav-link active" data-scroll-target="#job-seeker-insights-and-recommendations"><span class="header-section-number">1</span> Job Seeker Insights and Recommendations</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Job Seeker Insights and Recommendations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="1">
<div class="cell-output cell-output-stdout">
<pre><code>error: externally-managed-environment

× This environment is externally managed
╰─&gt; To install Python packages system-wide, try apt install
    python3-xyz, where xyz is the package you are trying to
    install.
    
    If you wish to install a non-Debian-packaged Python package,
    create a virtual environment using python3 -m venv path/to/venv.
    Then use path/to/venv/bin/python and path/to/venv/bin/pip. Make
    sure you have python3-full installed.
    
    If you wish to install a non-Debian packaged Python application,
    it may be easiest to use pipx install xyz, which will manage a
    virtual environment for you. Make sure you have pipx installed.
    
    See /usr/share/doc/python3.12/README.venv for more information.

note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.
hint: See PEP 668 for the detailed specification.</code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stderr">
<pre><code>Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
25/05/01 14:33:24 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
                                                                                </code></pre>
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="3">
<div class="cell-output cell-output-stdout">
<pre><code>root
 |-- ID: string (nullable = true)
 |-- LAST_UPDATED_DATE: string (nullable = true)
 |-- LAST_UPDATED_TIMESTAMP: string (nullable = true)
 |-- DUPLICATES: string (nullable = true)
 |-- POSTED: string (nullable = true)
 |-- EXPIRED: string (nullable = true)
 |-- DURATION: string (nullable = true)
 |-- SOURCE_TYPES: string (nullable = true)
 |-- SOURCES: string (nullable = true)
 |-- URL: string (nullable = true)
 |-- ACTIVE_URLS: string (nullable = true)
 |-- ACTIVE_SOURCES_INFO: string (nullable = true)
 |-- TITLE_RAW: string (nullable = true)
 |-- BODY: string (nullable = true)
 |-- MODELED_EXPIRED: string (nullable = true)
 |-- MODELED_DURATION: string (nullable = true)
 |-- COMPANY: string (nullable = true)
 |-- COMPANY_NAME: string (nullable = true)
 |-- COMPANY_RAW: string (nullable = true)
 |-- COMPANY_IS_STAFFING: string (nullable = true)
 |-- EDUCATION_LEVELS: string (nullable = true)
 |-- EDUCATION_LEVELS_NAME: string (nullable = true)
 |-- MIN_EDULEVELS: string (nullable = true)
 |-- MIN_EDULEVELS_NAME: string (nullable = true)
 |-- MAX_EDULEVELS: string (nullable = true)
 |-- MAX_EDULEVELS_NAME: string (nullable = true)
 |-- EMPLOYMENT_TYPE: string (nullable = true)
 |-- EMPLOYMENT_TYPE_NAME: string (nullable = true)
 |-- MIN_YEARS_EXPERIENCE: string (nullable = true)
 |-- MAX_YEARS_EXPERIENCE: string (nullable = true)
 |-- IS_INTERNSHIP: string (nullable = true)
 |-- SALARY: string (nullable = true)
 |-- REMOTE_TYPE: string (nullable = true)
 |-- REMOTE_TYPE_NAME: string (nullable = true)
 |-- ORIGINAL_PAY_PERIOD: string (nullable = true)
 |-- SALARY_TO: string (nullable = true)
 |-- SALARY_FROM: string (nullable = true)
 |-- LOCATION: string (nullable = true)
 |-- CITY: string (nullable = true)
 |-- CITY_NAME: string (nullable = true)
 |-- COUNTY: string (nullable = true)
 |-- COUNTY_NAME: string (nullable = true)
 |-- MSA: string (nullable = true)
 |-- MSA_NAME: string (nullable = true)
 |-- STATE: string (nullable = true)
 |-- STATE_NAME: string (nullable = true)
 |-- COUNTY_OUTGOING: string (nullable = true)
 |-- COUNTY_NAME_OUTGOING: string (nullable = true)
 |-- COUNTY_INCOMING: string (nullable = true)
 |-- COUNTY_NAME_INCOMING: string (nullable = true)
 |-- MSA_OUTGOING: string (nullable = true)
 |-- MSA_NAME_OUTGOING: string (nullable = true)
 |-- MSA_INCOMING: string (nullable = true)
 |-- MSA_NAME_INCOMING: string (nullable = true)
 |-- NAICS2: string (nullable = true)
 |-- NAICS2_NAME: string (nullable = true)
 |-- NAICS3: string (nullable = true)
 |-- NAICS3_NAME: string (nullable = true)
 |-- NAICS4: string (nullable = true)
 |-- NAICS4_NAME: string (nullable = true)
 |-- NAICS5: string (nullable = true)
 |-- NAICS5_NAME: string (nullable = true)
 |-- NAICS6: string (nullable = true)
 |-- NAICS6_NAME: string (nullable = true)
 |-- TITLE: string (nullable = true)
 |-- TITLE_NAME: string (nullable = true)
 |-- TITLE_CLEAN: string (nullable = true)
 |-- SKILLS: string (nullable = true)
 |-- SKILLS_NAME: string (nullable = true)
 |-- SPECIALIZED_SKILLS: string (nullable = true)
 |-- SPECIALIZED_SKILLS_NAME: string (nullable = true)
 |-- CERTIFICATIONS: string (nullable = true)
 |-- CERTIFICATIONS_NAME: string (nullable = true)
 |-- COMMON_SKILLS: string (nullable = true)
 |-- COMMON_SKILLS_NAME: string (nullable = true)
 |-- SOFTWARE_SKILLS: string (nullable = true)
 |-- SOFTWARE_SKILLS_NAME: string (nullable = true)
 |-- ONET: string (nullable = true)
 |-- ONET_NAME: string (nullable = true)
 |-- ONET_2019: string (nullable = true)
 |-- ONET_2019_NAME: string (nullable = true)
 |-- CIP6: string (nullable = true)
 |-- CIP6_NAME: string (nullable = true)
 |-- CIP4: string (nullable = true)
 |-- CIP4_NAME: string (nullable = true)
 |-- CIP2: string (nullable = true)
 |-- CIP2_NAME: string (nullable = true)
 |-- SOC_2021_2: string (nullable = true)
 |-- SOC_2021_2_NAME: string (nullable = true)
 |-- SOC_2021_3: string (nullable = true)
 |-- SOC_2021_3_NAME: string (nullable = true)
 |-- SOC_2021_4: string (nullable = true)
 |-- SOC_2021_4_NAME: string (nullable = true)
 |-- SOC_2021_5: string (nullable = true)
 |-- SOC_2021_5_NAME: string (nullable = true)
 |-- LOT_CAREER_AREA: string (nullable = true)
 |-- LOT_CAREER_AREA_NAME: string (nullable = true)
 |-- LOT_OCCUPATION: string (nullable = true)
 |-- LOT_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_SPECIALIZED_OCCUPATION: string (nullable = true)
 |-- LOT_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_OCCUPATION_GROUP: string (nullable = true)
 |-- LOT_OCCUPATION_GROUP_NAME: string (nullable = true)
 |-- LOT_V6_SPECIALIZED_OCCUPATION: string (nullable = true)
 |-- LOT_V6_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_V6_OCCUPATION: string (nullable = true)
 |-- LOT_V6_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_V6_OCCUPATION_GROUP: string (nullable = true)
 |-- LOT_V6_OCCUPATION_GROUP_NAME: string (nullable = true)
 |-- LOT_V6_CAREER_AREA: string (nullable = true)
 |-- LOT_V6_CAREER_AREA_NAME: string (nullable = true)
 |-- SOC_2: string (nullable = true)
 |-- SOC_2_NAME: string (nullable = true)
 |-- SOC_3: string (nullable = true)
 |-- SOC_3_NAME: string (nullable = true)
 |-- SOC_4: string (nullable = true)
 |-- SOC_4_NAME: string (nullable = true)
 |-- SOC_5: string (nullable = true)
 |-- SOC_5_NAME: string (nullable = true)
 |-- LIGHTCAST_SECTORS: string (nullable = true)
 |-- LIGHTCAST_SECTORS_NAME: string (nullable = true)
 |-- NAICS_2022_2: string (nullable = true)
 |-- NAICS_2022_2_NAME: string (nullable = true)
 |-- NAICS_2022_3: string (nullable = true)
 |-- NAICS_2022_3_NAME: string (nullable = true)
 |-- NAICS_2022_4: string (nullable = true)
 |-- NAICS_2022_4_NAME: string (nullable = true)
 |-- NAICS_2022_5: string (nullable = true)
 |-- NAICS_2022_5_NAME: string (nullable = true)
 |-- NAICS_2022_6: string (nullable = true)
 |-- NAICS_2022_6_NAME: string (nullable = true)
</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="4">
<div class="cell-output cell-output-stderr">
<pre><code>25/05/01 10:23:42 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
ERROR:root:KeyboardInterrupt while sending command.                 (0 + 1) / 1]
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/.local/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[4], line 10</span>
<span class="ansi-green-fg ansi-bold">      7</span> <span style="font-style:italic;color:rgb(95,135,135)"># Step 4: Take 100 rows</span>
<span class="ansi-green-fg ansi-bold">      8</span> sample_df <span style="color:rgb(98,98,98)">=</span> filtered_df<span style="color:rgb(98,98,98)">.</span>limit(<span style="color:rgb(98,98,98)">100</span>)
<span class="ansi-green-fg">---&gt; 10</span> sample_pd <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">sample_df</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">toPandas</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     11</span> sample_pd<span style="color:rgb(98,98,98)">.</span>to_csv(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">sample_job_data.csv</span><span style="color:rgb(175,0,0)">"</span>, index<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">False</span>)

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/pyspark/sql/pandas/conversion.py:202</span>, in <span class="ansi-cyan-fg">PandasConversionMixin.toPandas</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">    199</span>             <span style="font-weight:bold;color:rgb(0,135,0)">raise</span>
<span class="ansi-green-fg ansi-bold">    201</span> <span style="font-style:italic;color:rgb(95,135,135)"># Below is toPandas without Arrow optimization.</span>
<span class="ansi-green-fg">--&gt; 202</span> rows <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">collect</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    203</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">len</span>(rows) <span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(98,98,98)">0</span>:
<span class="ansi-green-fg ansi-bold">    204</span>     pdf <span style="color:rgb(98,98,98)">=</span> pd<span style="color:rgb(98,98,98)">.</span>DataFrame<span style="color:rgb(98,98,98)">.</span>from_records(
<span class="ansi-green-fg ansi-bold">    205</span>         rows, index<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">range</span>(<span style="color:rgb(0,135,0)">len</span>(rows)), columns<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>columns  <span style="font-style:italic;color:rgb(95,135,135)"># type: ignore[arg-type]</span>
<span class="ansi-green-fg ansi-bold">    206</span>     )

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/pyspark/sql/dataframe.py:1263</span>, in <span class="ansi-cyan-fg">DataFrame.collect</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-fg ansi-bold">   1243</span> <span style="font-style:italic;color:rgb(175,0,0)">"""Returns all the records as a list of :class:`Row`.</span>
<span class="ansi-green-fg ansi-bold">   1244</span> 
<span class="ansi-green-fg ansi-bold">   1245</span> <span style="font-style:italic;color:rgb(175,0,0)">.. versionadded:: 1.3.0</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-fg ansi-bold">   1260</span> <span style="font-style:italic;color:rgb(175,0,0)">[Row(age=14, name='Tom'), Row(age=23, name='Alice'), Row(age=16, name='Bob')]</span>
<span class="ansi-green-fg ansi-bold">   1261</span> <span style="font-style:italic;color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">   1262</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> SCCallSiteSync(<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_sc):
<span class="ansi-green-fg">-&gt; 1263</span>     sock_info <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_jdf</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">collectToPython</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1264</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)">list</span>(_load_from_socket(sock_info, BatchedSerializer(CPickleSerializer())))

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/py4j/java_gateway.py:1321</span>, in <span class="ansi-cyan-fg">JavaMember.__call__</span><span class="ansi-blue-fg">(self, *args)</span>
<span class="ansi-green-fg ansi-bold">   1314</span> args_command, temp_args <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_build_args(<span style="color:rgb(98,98,98)">*</span>args)
<span class="ansi-green-fg ansi-bold">   1316</span> command <span style="color:rgb(98,98,98)">=</span> proto<span style="color:rgb(98,98,98)">.</span>CALL_COMMAND_NAME <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1317</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>command_header <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1318</span>     args_command <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1319</span>     proto<span style="color:rgb(98,98,98)">.</span>END_COMMAND_PART
<span class="ansi-green-fg">-&gt; 1321</span> answer <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">gateway_client</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">send_command</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">command</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1322</span> return_value <span style="color:rgb(98,98,98)">=</span> get_return_value(
<span class="ansi-green-fg ansi-bold">   1323</span>     answer, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>gateway_client, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>target_id, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>name)
<span class="ansi-green-fg ansi-bold">   1325</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> temp_arg <span style="font-weight:bold;color:rgb(175,0,255)">in</span> temp_args:

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/py4j/java_gateway.py:1038</span>, in <span class="ansi-cyan-fg">GatewayClient.send_command</span><span class="ansi-blue-fg">(self, command, retry, binary)</span>
<span class="ansi-green-fg ansi-bold">   1036</span> connection <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_get_connection()
<span class="ansi-green-fg ansi-bold">   1037</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">-&gt; 1038</span>     response <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">connection</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">send_command</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">command</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1039</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> binary:
<span class="ansi-green-fg ansi-bold">   1040</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> response, <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_create_connection_guard(connection)

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/py4j/clientserver.py:511</span>, in <span class="ansi-cyan-fg">ClientServerConnection.send_command</span><span class="ansi-blue-fg">(self, command)</span>
<span class="ansi-green-fg ansi-bold">    509</span> <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg ansi-bold">    510</span>     <span style="font-weight:bold;color:rgb(0,135,0)">while</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>:
<span class="ansi-green-fg">--&gt; 511</span>         answer <span style="color:rgb(98,98,98)">=</span> smart_decode(<span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">stream</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">readline</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>[:<span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">1</span>])
<span class="ansi-green-fg ansi-bold">    512</span>         logger<span style="color:rgb(98,98,98)">.</span>debug(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Answer received: </span><span style="font-weight:bold;color:rgb(175,95,135)">{0}</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(98,98,98)">.</span>format(answer))
<span class="ansi-green-fg ansi-bold">    513</span>         <span style="font-style:italic;color:rgb(95,135,135)"># Happens when a the other end is dead. There might be an empty</span>
<span class="ansi-green-fg ansi-bold">    514</span>         <span style="font-style:italic;color:rgb(95,135,135)"># answer before the socket raises an error.</span>

File <span class="ansi-green-fg">/usr/lib/python3.12/socket.py:707</span>, in <span class="ansi-cyan-fg">SocketIO.readinto</span><span class="ansi-blue-fg">(self, b)</span>
<span class="ansi-green-fg ansi-bold">    705</span> <span style="font-weight:bold;color:rgb(0,135,0)">while</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>:
<span class="ansi-green-fg ansi-bold">    706</span>     <span style="font-weight:bold;color:rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; 707</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_sock</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">recv_into</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">b</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    708</span>     <span style="font-weight:bold;color:rgb(0,135,0)">except</span> timeout:
<span class="ansi-green-fg ansi-bold">    709</span>         <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_timeout_occurred <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Exception in thread "serve-DataFrame" java.net.SocketTimeoutException: Accept timed out
    at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
    at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)
    at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
    at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
    at org.apache.spark.security.SocketAuthServer$$anon$1.run(SocketAuthServer.scala:65)</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stderr">
<pre><code>                                                                                </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+--------------------+----------------------+----------+--------------------+-------+--------------------+------------+---------------+-----+--------------------+-------------------+--------------------+--------+--------------------+----------------+--------------------+------------+--------------------+-------------------+--------------------+---------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+---------------+-------+---------------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+----+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
| ID|   LAST_UPDATED_DATE|LAST_UPDATED_TIMESTAMP|DUPLICATES|              POSTED|EXPIRED|            DURATION|SOURCE_TYPES|        SOURCES|  URL|         ACTIVE_URLS|ACTIVE_SOURCES_INFO|           TITLE_RAW|    BODY|     MODELED_EXPIRED|MODELED_DURATION|             COMPANY|COMPANY_NAME|         COMPANY_RAW|COMPANY_IS_STAFFING|    EDUCATION_LEVELS|EDUCATION_LEVELS_NAME|       MIN_EDULEVELS|MIN_EDULEVELS_NAME|       MAX_EDULEVELS|MAX_EDULEVELS_NAME|     EMPLOYMENT_TYPE|EMPLOYMENT_TYPE_NAME|MIN_YEARS_EXPERIENCE|MAX_YEARS_EXPERIENCE|  IS_INTERNSHIP| SALARY|    REMOTE_TYPE|REMOTE_TYPE_NAME|ORIGINAL_PAY_PERIOD|SALARY_TO|SALARY_FROM|LOCATION|CITY|CITY_NAME|COUNTY|COUNTY_NAME| MSA|MSA_NAME|STATE|STATE_NAME|COUNTY_OUTGOING|COUNTY_NAME_OUTGOING|COUNTY_INCOMING|COUNTY_NAME_INCOMING|MSA_OUTGOING|MSA_NAME_OUTGOING|MSA_INCOMING|MSA_NAME_INCOMING|NAICS2|NAICS2_NAME|NAICS3|NAICS3_NAME|NAICS4|NAICS4_NAME|NAICS5|NAICS5_NAME|NAICS6|NAICS6_NAME|TITLE|TITLE_NAME|TITLE_CLEAN|SKILLS|SKILLS_NAME|SPECIALIZED_SKILLS|SPECIALIZED_SKILLS_NAME|CERTIFICATIONS|CERTIFICATIONS_NAME|COMMON_SKILLS|COMMON_SKILLS_NAME|SOFTWARE_SKILLS|SOFTWARE_SKILLS_NAME|ONET|ONET_NAME|ONET_2019|ONET_2019_NAME|CIP6|CIP6_NAME|CIP4|CIP4_NAME|CIP2|CIP2_NAME|SOC_2021_2|SOC_2021_2_NAME|SOC_2021_3|SOC_2021_3_NAME|SOC_2021_4|SOC_2021_4_NAME|SOC_2021_5|SOC_2021_5_NAME|LOT_CAREER_AREA|LOT_CAREER_AREA_NAME|LOT_OCCUPATION|LOT_OCCUPATION_NAME|LOT_SPECIALIZED_OCCUPATION|LOT_SPECIALIZED_OCCUPATION_NAME|LOT_OCCUPATION_GROUP|LOT_OCCUPATION_GROUP_NAME|LOT_V6_SPECIALIZED_OCCUPATION|LOT_V6_SPECIALIZED_OCCUPATION_NAME|LOT_V6_OCCUPATION|LOT_V6_OCCUPATION_NAME|LOT_V6_OCCUPATION_GROUP|LOT_V6_OCCUPATION_GROUP_NAME|LOT_V6_CAREER_AREA|LOT_V6_CAREER_AREA_NAME|SOC_2|SOC_2_NAME|SOC_3|SOC_3_NAME|SOC_4|SOC_4_NAME|SOC_5|SOC_5_NAME|LIGHTCAST_SECTORS|LIGHTCAST_SECTORS_NAME|NAICS_2022_2|NAICS_2022_2_NAME|NAICS_2022_3|NAICS_2022_3_NAME|NAICS_2022_4|NAICS_2022_4_NAME|NAICS_2022_5|NAICS_2022_5_NAME|NAICS_2022_6|NAICS_2022_6_NAME|
+---+--------------------+----------------------+----------+--------------------+-------+--------------------+------------+---------------+-----+--------------------+-------------------+--------------------+--------+--------------------+----------------+--------------------+------------+--------------------+-------------------+--------------------+---------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+---------------+-------+---------------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+----+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
| ]"|                   2|     Bachelor's degree|      NULL|                NULL|      1|Full-time (&gt; 32 h...|           2|              2|FALSE|                NULL|                  0|              [None]|    NULL|                NULL|            NULL|                   {|        NULL|                NULL|               NULL|                NULL|                 NULL|                NULL|              NULL|                NULL|              NULL|                NULL|                NULL|                NULL|                NULL|           NULL|   NULL|           NULL|            NULL|               NULL|     NULL|       NULL|    NULL|NULL|     NULL|  NULL|       NULL|NULL|    NULL| NULL|      NULL|           NULL|                NULL|           NULL|                NULL|        NULL|             NULL|        NULL|             NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL| NULL|      NULL|       NULL|  NULL|       NULL|              NULL|                   NULL|          NULL|               NULL|         NULL|              NULL|           NULL|                NULL|NULL|     NULL|     NULL|          NULL|NULL|     NULL|NULL|     NULL|NULL|     NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|           NULL|                NULL|          NULL|               NULL|                      NULL|                           NULL|                NULL|                     NULL|                         NULL|                              NULL|             NULL|                  NULL|                   NULL|                        NULL|              NULL|                   NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL|             NULL|                  NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|
| }"|RWwgRG9yYWRvLCBBUg==|         El Dorado, AR|      5139|           Union, AR|  20980|       El Dorado, AR|           5|       Arkansas| 5139|           Union, AR|               5139|           Union, AR|   20980|       El Dorado, AR|           20980|       El Dorado, AR|          44|        Retail Trade|                441|Motor Vehicle and...|                 4413|Automotive Parts,...|             44133|Automotive Parts ...|            441330|Automotive Parts ...|  ET29C073C03D1F86B4| Enterprise Analysts|enterprise analys...|              [|   NULL|           NULL|            NULL|               NULL|     NULL|       NULL|    NULL|NULL|     NULL|  NULL|       NULL|NULL|    NULL| NULL|      NULL|           NULL|                NULL|           NULL|                NULL|        NULL|             NULL|        NULL|             NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL| NULL|      NULL|       NULL|  NULL|       NULL|              NULL|                   NULL|          NULL|               NULL|         NULL|              NULL|           NULL|                NULL|NULL|     NULL|     NULL|          NULL|NULL|     NULL|NULL|     NULL|NULL|     NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|           NULL|                NULL|          NULL|               NULL|                      NULL|                           NULL|                NULL|                     NULL|                         NULL|                              NULL|             NULL|                  NULL|                   NULL|                        NULL|              NULL|                   NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL|             NULL|                  NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|
| ]"|             15-0000|  Computer and Math...|   15-2000|Mathematical Scie...|15-2050|     Data Scientists|     15-2051|Data Scientists|   23|Information Techn...|             231010|Business Intellig...|23101011|General ERP Analy...|            2310|Business Intellig...|    23101011|General ERP Analy...|             231010|Business Intellig...|                 2310|Business Intellig...|                23|Information Techn...|           15-0000|Computer and Math...|             15-2000|Mathematical Scie...|             15-2050|Data Scientists|15-2051|Data Scientists|               [|               NULL|     NULL|       NULL|    NULL|NULL|     NULL|  NULL|       NULL|NULL|    NULL| NULL|      NULL|           NULL|                NULL|           NULL|                NULL|        NULL|             NULL|        NULL|             NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL| NULL|      NULL|       NULL|  NULL|       NULL|              NULL|                   NULL|          NULL|               NULL|         NULL|              NULL|           NULL|                NULL|NULL|     NULL|     NULL|          NULL|NULL|     NULL|NULL|     NULL|NULL|     NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|           NULL|                NULL|          NULL|               NULL|                      NULL|                           NULL|                NULL|                     NULL|                         NULL|                              NULL|             NULL|                  NULL|                   NULL|                        NULL|              NULL|                   NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL|             NULL|                  NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|
| ]"|                  99|   No Education Listed|      NULL|                NULL|      1|Full-time (&gt; 32 h...|           3|              3|FALSE|                NULL|                  1|              Remote|    NULL|                NULL|            NULL|                   {|        NULL|                NULL|               NULL|                NULL|                 NULL|                NULL|              NULL|                NULL|              NULL|                NULL|                NULL|                NULL|                NULL|           NULL|   NULL|           NULL|            NULL|               NULL|     NULL|       NULL|    NULL|NULL|     NULL|  NULL|       NULL|NULL|    NULL| NULL|      NULL|           NULL|                NULL|           NULL|                NULL|        NULL|             NULL|        NULL|             NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL| NULL|      NULL|       NULL|  NULL|       NULL|              NULL|                   NULL|          NULL|               NULL|         NULL|              NULL|           NULL|                NULL|NULL|     NULL|     NULL|          NULL|NULL|     NULL|NULL|     NULL|NULL|     NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|           NULL|                NULL|          NULL|               NULL|                      NULL|                           NULL|                NULL|                     NULL|                         NULL|                              NULL|             NULL|                  NULL|                   NULL|                        NULL|              NULL|                   NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL|             NULL|                  NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|
| }"|    QXVndXN0YSwgTUU=|           Augusta, ME|     23011|        Kennebec, ME|  12300|Augusta-Watervill...|          23|          Maine|23011|        Kennebec, ME|              23011|        Kennebec, ME|   12300|Augusta-Watervill...|           12300|Augusta-Watervill...|          56|Administrative an...|                561|Administrative an...|                 5613| Employment Services|             56132|Temporary Help Se...|            561320|Temporary Help Se...|  ET21DDA63780A7DC09|  Oracle Consultants|oracle consultant...|              [|   NULL|           NULL|            NULL|               NULL|     NULL|       NULL|    NULL|NULL|     NULL|  NULL|       NULL|NULL|    NULL| NULL|      NULL|           NULL|                NULL|           NULL|                NULL|        NULL|             NULL|        NULL|             NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL|  NULL|       NULL| NULL|      NULL|       NULL|  NULL|       NULL|              NULL|                   NULL|          NULL|               NULL|         NULL|              NULL|           NULL|                NULL|NULL|     NULL|     NULL|          NULL|NULL|     NULL|NULL|     NULL|NULL|     NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|      NULL|           NULL|           NULL|                NULL|          NULL|               NULL|                      NULL|                           NULL|                NULL|                     NULL|                         NULL|                              NULL|             NULL|                  NULL|                   NULL|                        NULL|              NULL|                   NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL| NULL|      NULL|             NULL|                  NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|        NULL|             NULL|
+---+--------------------+----------------------+----------+--------------------+-------+--------------------+------------+---------------+-----+--------------------+-------------------+--------------------+--------+--------------------+----------------+--------------------+------------+--------------------+-------------------+--------------------+---------------------+--------------------+------------------+--------------------+------------------+--------------------+--------------------+--------------------+--------------------+---------------+-------+---------------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+----+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
only showing top 5 rows

root
 |-- ID: string (nullable = true)
 |-- LAST_UPDATED_DATE: string (nullable = true)
 |-- LAST_UPDATED_TIMESTAMP: string (nullable = true)
 |-- DUPLICATES: string (nullable = true)
 |-- POSTED: string (nullable = true)
 |-- EXPIRED: string (nullable = true)
 |-- DURATION: string (nullable = true)
 |-- SOURCE_TYPES: string (nullable = true)
 |-- SOURCES: string (nullable = true)
 |-- URL: string (nullable = true)
 |-- ACTIVE_URLS: string (nullable = true)
 |-- ACTIVE_SOURCES_INFO: string (nullable = true)
 |-- TITLE_RAW: string (nullable = true)
 |-- BODY: string (nullable = true)
 |-- MODELED_EXPIRED: string (nullable = true)
 |-- MODELED_DURATION: string (nullable = true)
 |-- COMPANY: string (nullable = true)
 |-- COMPANY_NAME: string (nullable = true)
 |-- COMPANY_RAW: string (nullable = true)
 |-- COMPANY_IS_STAFFING: string (nullable = true)
 |-- EDUCATION_LEVELS: string (nullable = true)
 |-- EDUCATION_LEVELS_NAME: string (nullable = true)
 |-- MIN_EDULEVELS: string (nullable = true)
 |-- MIN_EDULEVELS_NAME: string (nullable = true)
 |-- MAX_EDULEVELS: string (nullable = true)
 |-- MAX_EDULEVELS_NAME: string (nullable = true)
 |-- EMPLOYMENT_TYPE: string (nullable = true)
 |-- EMPLOYMENT_TYPE_NAME: string (nullable = true)
 |-- MIN_YEARS_EXPERIENCE: string (nullable = true)
 |-- MAX_YEARS_EXPERIENCE: string (nullable = true)
 |-- IS_INTERNSHIP: string (nullable = true)
 |-- SALARY: string (nullable = true)
 |-- REMOTE_TYPE: string (nullable = true)
 |-- REMOTE_TYPE_NAME: string (nullable = true)
 |-- ORIGINAL_PAY_PERIOD: string (nullable = true)
 |-- SALARY_TO: string (nullable = true)
 |-- SALARY_FROM: string (nullable = true)
 |-- LOCATION: string (nullable = true)
 |-- CITY: string (nullable = true)
 |-- CITY_NAME: string (nullable = true)
 |-- COUNTY: string (nullable = true)
 |-- COUNTY_NAME: string (nullable = true)
 |-- MSA: string (nullable = true)
 |-- MSA_NAME: string (nullable = true)
 |-- STATE: string (nullable = true)
 |-- STATE_NAME: string (nullable = true)
 |-- COUNTY_OUTGOING: string (nullable = true)
 |-- COUNTY_NAME_OUTGOING: string (nullable = true)
 |-- COUNTY_INCOMING: string (nullable = true)
 |-- COUNTY_NAME_INCOMING: string (nullable = true)
 |-- MSA_OUTGOING: string (nullable = true)
 |-- MSA_NAME_OUTGOING: string (nullable = true)
 |-- MSA_INCOMING: string (nullable = true)
 |-- MSA_NAME_INCOMING: string (nullable = true)
 |-- NAICS2: string (nullable = true)
 |-- NAICS2_NAME: string (nullable = true)
 |-- NAICS3: string (nullable = true)
 |-- NAICS3_NAME: string (nullable = true)
 |-- NAICS4: string (nullable = true)
 |-- NAICS4_NAME: string (nullable = true)
 |-- NAICS5: string (nullable = true)
 |-- NAICS5_NAME: string (nullable = true)
 |-- NAICS6: string (nullable = true)
 |-- NAICS6_NAME: string (nullable = true)
 |-- TITLE: integer (nullable = true)
 |-- TITLE_NAME: string (nullable = true)
 |-- TITLE_CLEAN: string (nullable = true)
 |-- SKILLS: string (nullable = true)
 |-- SKILLS_NAME: string (nullable = true)
 |-- SPECIALIZED_SKILLS: string (nullable = true)
 |-- SPECIALIZED_SKILLS_NAME: integer (nullable = true)
 |-- CERTIFICATIONS: string (nullable = true)
 |-- CERTIFICATIONS_NAME: integer (nullable = true)
 |-- COMMON_SKILLS: string (nullable = true)
 |-- COMMON_SKILLS_NAME: string (nullable = true)
 |-- SOFTWARE_SKILLS: string (nullable = true)
 |-- SOFTWARE_SKILLS_NAME: string (nullable = true)
 |-- ONET: string (nullable = true)
 |-- ONET_NAME: string (nullable = true)
 |-- ONET_2019: string (nullable = true)
 |-- ONET_2019_NAME: string (nullable = true)
 |-- CIP6: string (nullable = true)
 |-- CIP6_NAME: string (nullable = true)
 |-- CIP4: string (nullable = true)
 |-- CIP4_NAME: integer (nullable = true)
 |-- CIP2: string (nullable = true)
 |-- CIP2_NAME: integer (nullable = true)
 |-- SOC_2021_2: string (nullable = true)
 |-- SOC_2021_2_NAME: integer (nullable = true)
 |-- SOC_2021_3: string (nullable = true)
 |-- SOC_2021_3_NAME: integer (nullable = true)
 |-- SOC_2021_4: string (nullable = true)
 |-- SOC_2021_4_NAME: integer (nullable = true)
 |-- SOC_2021_5: string (nullable = true)
 |-- SOC_2021_5_NAME: string (nullable = true)
 |-- LOT_CAREER_AREA: string (nullable = true)
 |-- LOT_CAREER_AREA_NAME: string (nullable = true)
 |-- LOT_OCCUPATION: string (nullable = true)
 |-- LOT_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_SPECIALIZED_OCCUPATION: string (nullable = true)
 |-- LOT_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_OCCUPATION_GROUP: string (nullable = true)
 |-- LOT_OCCUPATION_GROUP_NAME: string (nullable = true)
 |-- LOT_V6_SPECIALIZED_OCCUPATION: string (nullable = true)
 |-- LOT_V6_SPECIALIZED_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_V6_OCCUPATION: string (nullable = true)
 |-- LOT_V6_OCCUPATION_NAME: string (nullable = true)
 |-- LOT_V6_OCCUPATION_GROUP: string (nullable = true)
 |-- LOT_V6_OCCUPATION_GROUP_NAME: string (nullable = true)
 |-- LOT_V6_CAREER_AREA: string (nullable = true)
 |-- LOT_V6_CAREER_AREA_NAME: string (nullable = true)
 |-- SOC_2: string (nullable = true)
 |-- SOC_2_NAME: string (nullable = true)
 |-- SOC_3: string (nullable = true)
 |-- SOC_3_NAME: string (nullable = true)
 |-- SOC_4: string (nullable = true)
 |-- SOC_4_NAME: string (nullable = true)
 |-- SOC_5: string (nullable = true)
 |-- SOC_5_NAME: string (nullable = true)
 |-- LIGHTCAST_SECTORS: string (nullable = true)
 |-- LIGHTCAST_SECTORS_NAME: string (nullable = true)
 |-- NAICS_2022_2: string (nullable = true)
 |-- NAICS_2022_2_NAME: string (nullable = true)
 |-- NAICS_2022_3: string (nullable = true)
 |-- NAICS_2022_3_NAME: string (nullable = true)
 |-- NAICS_2022_4: string (nullable = true)
 |-- NAICS_2022_4_NAME: string (nullable = true)
 |-- NAICS_2022_5: string (nullable = true)
 |-- NAICS_2022_5_NAME: string (nullable = true)
 |-- NAICS_2022_6: string (nullable = true)
 |-- NAICS_2022_6_NAME: string (nullable = true)
</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="3">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 100, Columns: 131</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[Stage 10:&gt;                                                         (0 + 1) / 1]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
| ID|LAST_UPDATED_DATE|LAST_UPDATED_TIMESTAMP|DUPLICATES|POSTED|EXPIRED|DURATION|SOURCE_TYPES|SOURCES|URL|ACTIVE_URLS|ACTIVE_SOURCES_INFO|TITLE_RAW|BODY|MODELED_EXPIRED|MODELED_DURATION|COMPANY|COMPANY_NAME|COMPANY_RAW|COMPANY_IS_STAFFING|EDUCATION_LEVELS|EDUCATION_LEVELS_NAME|MIN_EDULEVELS|MIN_EDULEVELS_NAME|MAX_EDULEVELS|MAX_EDULEVELS_NAME|EMPLOYMENT_TYPE|EMPLOYMENT_TYPE_NAME|MIN_YEARS_EXPERIENCE|MAX_YEARS_EXPERIENCE|IS_INTERNSHIP|SALARY|REMOTE_TYPE|REMOTE_TYPE_NAME|ORIGINAL_PAY_PERIOD|SALARY_TO|SALARY_FROM|LOCATION|CITY|CITY_NAME|COUNTY|COUNTY_NAME|MSA|MSA_NAME|STATE|STATE_NAME|COUNTY_OUTGOING|COUNTY_NAME_OUTGOING|COUNTY_INCOMING|COUNTY_NAME_INCOMING|MSA_OUTGOING|MSA_NAME_OUTGOING|MSA_INCOMING|MSA_NAME_INCOMING|NAICS2|NAICS2_NAME|NAICS3|NAICS3_NAME|NAICS4|NAICS4_NAME|NAICS5|NAICS5_NAME|NAICS6|NAICS6_NAME|TITLE|TITLE_NAME|TITLE_CLEAN|SKILLS|SKILLS_NAME|SPECIALIZED_SKILLS|SPECIALIZED_SKILLS_NAME|CERTIFICATIONS|CERTIFICATIONS_NAME|COMMON_SKILLS|COMMON_SKILLS_NAME|SOFTWARE_SKILLS|SOFTWARE_SKILLS_NAME|ONET|ONET_NAME|ONET_2019|ONET_2019_NAME|CIP6|CIP6_NAME|CIP4|CIP4_NAME|CIP2|CIP2_NAME|SOC_2021_2|SOC_2021_2_NAME|SOC_2021_3|SOC_2021_3_NAME|SOC_2021_4|SOC_2021_4_NAME|SOC_2021_5|SOC_2021_5_NAME|LOT_CAREER_AREA|LOT_CAREER_AREA_NAME|LOT_OCCUPATION|LOT_OCCUPATION_NAME|LOT_SPECIALIZED_OCCUPATION|LOT_SPECIALIZED_OCCUPATION_NAME|LOT_OCCUPATION_GROUP|LOT_OCCUPATION_GROUP_NAME|LOT_V6_SPECIALIZED_OCCUPATION|LOT_V6_SPECIALIZED_OCCUPATION_NAME|LOT_V6_OCCUPATION|LOT_V6_OCCUPATION_NAME|LOT_V6_OCCUPATION_GROUP|LOT_V6_OCCUPATION_GROUP_NAME|LOT_V6_CAREER_AREA|LOT_V6_CAREER_AREA_NAME|SOC_2|SOC_2_NAME|SOC_3|SOC_3_NAME|SOC_4|SOC_4_NAME|SOC_5|SOC_5_NAME|LIGHTCAST_SECTORS|LIGHTCAST_SECTORS_NAME|NAICS_2022_2|NAICS_2022_2_NAME|NAICS_2022_3|NAICS_2022_3_NAME|NAICS_2022_4|NAICS_2022_4_NAME|NAICS_2022_5|NAICS_2022_5_NAME|NAICS_2022_6|NAICS_2022_6_NAME|
+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
|  0|                0|                     4|        22|    22|      0|       0|          12|     23|  0|         18|                  0|        0|  16|             16|              16|      0|          32|         33|                 33|              36|                   36|           36|                36|           38|                40|             40|                  42|                  42|                  42|           42|    66|         66|              72|                 77|       71|         71|      71|  71|       71|    71|         71| 71|      79|   86|        86|             86|                  85|             85|                  84|          84|               84|          84|               84|    85|         93|    93|         95|    95|         96|    96|         96|    96|         96|   96|        96|         96|    96|         96|                98|                     98|            98|                 98|           98|                98|             98|                  98|  98|       98|       98|            98|  98|      100| 100|       98|  98|       98|        98|             98|        98|             98|        98|             98|        98|            100|            100|                 100|           100|                100|                       100|                            100|                 100|                      100|                          100|                               100|              100|                   100|                    100|                         100|               100|                    100|  100|       100|  100|       100|  100|       100|  100|       100|              100|                   100|         100|              100|         100|              100|         100|              100|         100|              100|         100|              100|
+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>                                                                                </code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="5">
<div class="cell-output cell-output-stdout">
<pre><code>+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
|ID |LAST_UPDATED_DATE|LAST_UPDATED_TIMESTAMP|DUPLICATES|POSTED|EXPIRED|DURATION|SOURCE_TYPES|SOURCES|URL|ACTIVE_URLS|ACTIVE_SOURCES_INFO|TITLE_RAW|BODY|MODELED_EXPIRED|MODELED_DURATION|COMPANY|COMPANY_NAME|COMPANY_RAW|COMPANY_IS_STAFFING|EDUCATION_LEVELS|EDUCATION_LEVELS_NAME|MIN_EDULEVELS|MIN_EDULEVELS_NAME|MAX_EDULEVELS|MAX_EDULEVELS_NAME|EMPLOYMENT_TYPE|EMPLOYMENT_TYPE_NAME|MIN_YEARS_EXPERIENCE|MAX_YEARS_EXPERIENCE|IS_INTERNSHIP|SALARY|REMOTE_TYPE|REMOTE_TYPE_NAME|ORIGINAL_PAY_PERIOD|SALARY_TO|SALARY_FROM|LOCATION|CITY|CITY_NAME|COUNTY|COUNTY_NAME|MSA|MSA_NAME|STATE|STATE_NAME|COUNTY_OUTGOING|COUNTY_NAME_OUTGOING|COUNTY_INCOMING|COUNTY_NAME_INCOMING|MSA_OUTGOING|MSA_NAME_OUTGOING|MSA_INCOMING|MSA_NAME_INCOMING|NAICS2|NAICS2_NAME|NAICS3|NAICS3_NAME|NAICS4|NAICS4_NAME|NAICS5|NAICS5_NAME|NAICS6|NAICS6_NAME|TITLE|TITLE_NAME|TITLE_CLEAN|SKILLS|SKILLS_NAME|SPECIALIZED_SKILLS|SPECIALIZED_SKILLS_NAME|CERTIFICATIONS|CERTIFICATIONS_NAME|COMMON_SKILLS|COMMON_SKILLS_NAME|SOFTWARE_SKILLS|SOFTWARE_SKILLS_NAME|ONET|ONET_NAME|ONET_2019|ONET_2019_NAME|CIP6|CIP6_NAME|CIP4|CIP4_NAME|CIP2|CIP2_NAME|SOC_2021_2|SOC_2021_2_NAME|SOC_2021_3|SOC_2021_3_NAME|SOC_2021_4|SOC_2021_4_NAME|SOC_2021_5|SOC_2021_5_NAME|LOT_CAREER_AREA|LOT_CAREER_AREA_NAME|LOT_OCCUPATION|LOT_OCCUPATION_NAME|LOT_SPECIALIZED_OCCUPATION|LOT_SPECIALIZED_OCCUPATION_NAME|LOT_OCCUPATION_GROUP|LOT_OCCUPATION_GROUP_NAME|LOT_V6_SPECIALIZED_OCCUPATION|LOT_V6_SPECIALIZED_OCCUPATION_NAME|LOT_V6_OCCUPATION|LOT_V6_OCCUPATION_NAME|LOT_V6_OCCUPATION_GROUP|LOT_V6_OCCUPATION_GROUP_NAME|LOT_V6_CAREER_AREA|LOT_V6_CAREER_AREA_NAME|SOC_2|SOC_2_NAME|SOC_3|SOC_3_NAME|SOC_4|SOC_4_NAME|SOC_5|SOC_5_NAME|LIGHTCAST_SECTORS|LIGHTCAST_SECTORS_NAME|NAICS_2022_2|NAICS_2022_2_NAME|NAICS_2022_3|NAICS_2022_3_NAME|NAICS_2022_4|NAICS_2022_4_NAME|NAICS_2022_5|NAICS_2022_5_NAME|NAICS_2022_6|NAICS_2022_6_NAME|
+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
+---+-----------------+----------------------+----------+------+-------+--------+------------+-------+---+-----------+-------------------+---------+----+---------------+----------------+-------+------------+-----------+-------------------+----------------+---------------------+-------------+------------------+-------------+------------------+---------------+--------------------+--------------------+--------------------+-------------+------+-----------+----------------+-------------------+---------+-----------+--------+----+---------+------+-----------+---+--------+-----+----------+---------------+--------------------+---------------+--------------------+------------+-----------------+------------+-----------------+------+-----------+------+-----------+------+-----------+------+-----------+------+-----------+-----+----------+-----------+------+-----------+------------------+-----------------------+--------------+-------------------+-------------+------------------+---------------+--------------------+----+---------+---------+--------------+----+---------+----+---------+----+---------+----------+---------------+----------+---------------+----------+---------------+----------+---------------+---------------+--------------------+--------------+-------------------+--------------------------+-------------------------------+--------------------+-------------------------+-----------------------------+----------------------------------+-----------------+----------------------+-----------------------+----------------------------+------------------+-----------------------+-----+----------+-----+----------+-----+----------+-----+----------+-----------------+----------------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+------------+-----------------+
</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="7">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">IllegalArgumentException</span>                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 9</span>
<span class="ansi-green-fg ansi-bold">      3</span> <span style="font-style:italic;color:rgb(95,135,135)"># Ensure correct column names (case-sensitive)</span>
<span class="ansi-green-fg ansi-bold">      4</span> assembler <span style="color:rgb(98,98,98)">=</span> VectorAssembler(
<span class="ansi-green-fg ansi-bold">      5</span>     inputCols<span style="color:rgb(98,98,98)">=</span>[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">SALARY</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">IsAI</span><span style="color:rgb(175,0,0)">"</span>],  <span style="font-style:italic;color:rgb(95,135,135)"># 'SALARY' not 'Salary'</span>
<span class="ansi-green-fg ansi-bold">      6</span>     outputCol<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">features</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg ansi-bold">      7</span> )
<span class="ansi-green-fg">----&gt; 9</span> assembled_data <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">assembler</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">df</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     10</span> assembled_data<span style="color:rgb(98,98,98)">.</span>select(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">TITLE</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">features</span><span style="color:rgb(175,0,0)">"</span>)<span style="color:rgb(98,98,98)">.</span>show(truncate<span style="color:rgb(98,98,98)">=</span><span style="font-weight:bold;color:rgb(0,135,0)">False</span>)

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/pyspark/ml/base.py:262</span>, in <span class="ansi-cyan-fg">Transformer.transform</span><span class="ansi-blue-fg">(self, dataset, params)</span>
<span class="ansi-green-fg ansi-bold">    260</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>copy(params)<span style="color:rgb(98,98,98)">.</span>_transform(dataset)
<span class="ansi-green-fg ansi-bold">    261</span>     <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 262</span>         <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dataset</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">    263</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg ansi-bold">    264</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">TypeError</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Params must be a param map but got </span><span style="font-weight:bold;color:rgb(175,95,135)">%s</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">"</span> <span style="color:rgb(98,98,98)">%</span> <span style="color:rgb(0,135,0)">type</span>(params))

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/pyspark/ml/wrapper.py:398</span>, in <span class="ansi-cyan-fg">JavaTransformer._transform</span><span class="ansi-blue-fg">(self, dataset)</span>
<span class="ansi-green-fg ansi-bold">    395</span> <span style="font-weight:bold;color:rgb(0,135,0)">assert</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_java_obj <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">    397</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_transfer_params_to_java()
<span class="ansi-green-fg">--&gt; 398</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> DataFrame(<span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_java_obj</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">transform</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">dataset</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_jdf</span><span class="ansi-yellow-bg">)</span>, dataset<span style="color:rgb(98,98,98)">.</span>sparkSession)

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/py4j/java_gateway.py:1322</span>, in <span class="ansi-cyan-fg">JavaMember.__call__</span><span class="ansi-blue-fg">(self, *args)</span>
<span class="ansi-green-fg ansi-bold">   1316</span> command <span style="color:rgb(98,98,98)">=</span> proto<span style="color:rgb(98,98,98)">.</span>CALL_COMMAND_NAME <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1317</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>command_header <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1318</span>     args_command <span style="color:rgb(98,98,98)">+</span>\
<span class="ansi-green-fg ansi-bold">   1319</span>     proto<span style="color:rgb(98,98,98)">.</span>END_COMMAND_PART
<span class="ansi-green-fg ansi-bold">   1321</span> answer <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>gateway_client<span style="color:rgb(98,98,98)">.</span>send_command(command)
<span class="ansi-green-fg">-&gt; 1322</span> return_value <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">get_return_value</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg ansi-bold">   1323</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">answer</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">gateway_client</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">target_id</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">   1325</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> temp_arg <span style="font-weight:bold;color:rgb(175,0,255)">in</span> temp_args:
<span class="ansi-green-fg ansi-bold">   1326</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">hasattr</span>(temp_arg, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">_detach</span><span style="color:rgb(175,0,0)">"</span>):

File <span class="ansi-green-fg">~/.local/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py:185</span>, in <span class="ansi-cyan-fg">capture_sql_exception.&lt;locals&gt;.deco</span><span class="ansi-blue-fg">(*a, **kw)</span>
<span class="ansi-green-fg ansi-bold">    181</span> converted <span style="color:rgb(98,98,98)">=</span> convert_exception(e<span style="color:rgb(98,98,98)">.</span>java_exception)
<span class="ansi-green-fg ansi-bold">    182</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(175,0,255)">not</span> <span style="color:rgb(0,135,0)">isinstance</span>(converted, UnknownException):
<span class="ansi-green-fg ansi-bold">    183</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Hide where the exception came from that shows a non-Pythonic</span>
<span class="ansi-green-fg ansi-bold">    184</span>     <span style="font-style:italic;color:rgb(95,135,135)"># JVM exception message.</span>
<span class="ansi-green-fg">--&gt; 185</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> converted <span style="font-weight:bold;color:rgb(0,135,0)">from</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">    186</span> <span style="font-weight:bold;color:rgb(0,135,0)">else</span>:
<span class="ansi-green-fg ansi-bold">    187</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span>

<span class="ansi-red-fg">IllegalArgumentException</span>: IsAI does not exist. Available: ID, LAST_UPDATED_DATE, LAST_UPDATED_TIMESTAMP, DUPLICATES, POSTED, EXPIRED, DURATION, SOURCE_TYPES, SOURCES, URL, ACTIVE_URLS, ACTIVE_SOURCES_INFO, TITLE_RAW, BODY, MODELED_EXPIRED, MODELED_DURATION, COMPANY, COMPANY_NAME, COMPANY_RAW, COMPANY_IS_STAFFING, EDUCATION_LEVELS, EDUCATION_LEVELS_NAME, MIN_EDULEVELS, MIN_EDULEVELS_NAME, MAX_EDULEVELS, MAX_EDULEVELS_NAME, EMPLOYMENT_TYPE, EMPLOYMENT_TYPE_NAME, MIN_YEARS_EXPERIENCE, MAX_YEARS_EXPERIENCE, IS_INTERNSHIP, SALARY, REMOTE_TYPE, REMOTE_TYPE_NAME, ORIGINAL_PAY_PERIOD, SALARY_TO, SALARY_FROM, LOCATION, CITY, CITY_NAME, COUNTY, COUNTY_NAME, MSA, MSA_NAME, STATE, STATE_NAME, COUNTY_OUTGOING, COUNTY_NAME_OUTGOING, COUNTY_INCOMING, COUNTY_NAME_INCOMING, MSA_OUTGOING, MSA_NAME_OUTGOING, MSA_INCOMING, MSA_NAME_INCOMING, NAICS2, NAICS2_NAME, NAICS3, NAICS3_NAME, NAICS4, NAICS4_NAME, NAICS5, NAICS5_NAME, NAICS6, NAICS6_NAME, TITLE, TITLE_NAME, TITLE_CLEAN, SKILLS, SKILLS_NAME, SPECIALIZED_SKILLS, SPECIALIZED_SKILLS_NAME, CERTIFICATIONS, CERTIFICATIONS_NAME, COMMON_SKILLS, COMMON_SKILLS_NAME, SOFTWARE_SKILLS, SOFTWARE_SKILLS_NAME, ONET, ONET_NAME, ONET_2019, ONET_2019_NAME, CIP6, CIP6_NAME, CIP4, CIP4_NAME, CIP2, CIP2_NAME, SOC_2021_2, SOC_2021_2_NAME, SOC_2021_3, SOC_2021_3_NAME, SOC_2021_4, SOC_2021_4_NAME, SOC_2021_5, SOC_2021_5_NAME, LOT_CAREER_AREA, LOT_CAREER_AREA_NAME, LOT_OCCUPATION, LOT_OCCUPATION_NAME, LOT_SPECIALIZED_OCCUPATION, LOT_SPECIALIZED_OCCUPATION_NAME, LOT_OCCUPATION_GROUP, LOT_OCCUPATION_GROUP_NAME, LOT_V6_SPECIALIZED_OCCUPATION, LOT_V6_SPECIALIZED_OCCUPATION_NAME, LOT_V6_OCCUPATION, LOT_V6_OCCUPATION_NAME, LOT_V6_OCCUPATION_GROUP, LOT_V6_OCCUPATION_GROUP_NAME, LOT_V6_CAREER_AREA, LOT_V6_CAREER_AREA_NAME, SOC_2, SOC_2_NAME, SOC_3, SOC_3_NAME, SOC_4, SOC_4_NAME, SOC_5, SOC_5_NAME, LIGHTCAST_SECTORS, LIGHTCAST_SECTORS_NAME, NAICS_2022_2, NAICS_2022_2_NAME, NAICS_2022_3, NAICS_2022_3_NAME, NAICS_2022_4, NAICS_2022_4_NAME, NAICS_2022_5, NAICS_2022_5_NAME, NAICS_2022_6, NAICS_2022_6_NAME</pre>
</div>
</div>
</div>
<p>Based on our analysis of job data from 2024:</p>
<ul>
<li><strong>AI-related jobs</strong> tend to offer significantly higher salaries across all industries, with the average salary in AI roles exceeding non-AI roles by over $45,000.</li>
<li><strong>Industry choice matters</strong> — Technology and Finance roles are high-paying, while roles in Marketing and Construction tend to offer lower compensation.</li>
<li><strong>AI classification is highly predictable</strong> from just salary and industry, suggesting a clear separation in job types.</li>
<li><strong>Clustering</strong> shows meaningful segmentation of roles, reinforcing that jobs naturally group into high-skill/high-pay and low-skill/low-pay categories.</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Job seekers looking to maximize salary potential should <strong>pivot toward AI-focused roles</strong>, especially in the Technology sector.</li>
<li>Candidates should consider <strong>upskilling with AI and data-related tools</strong> to stand out in the evolving market.</li>
<li>Non-AI professionals in lower-paying industries should consider <strong>geographic relocation, reskilling, or transitioning industries</strong> to remain competitive.</li>
</ul>
<section id="job-seeker-insights-and-recommendations" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="job-seeker-insights-and-recommendations"><span class="header-section-number">1</span> Job Seeker Insights and Recommendations</h2>
<p>Based on our analysis of job data from 2024:</p>
<ul>
<li><strong>AI-related jobs</strong> tend to offer significantly higher salaries across all industries, with the average salary in AI roles exceeding non-AI roles by over $45,000.</li>
<li><strong>Industry choice matters</strong> — Technology and Finance roles are high-paying, while roles in Marketing and Construction tend to offer lower compensation.</li>
<li><strong>AI classification is highly predictable</strong> from just salary and industry, suggesting a clear separation in job types.</li>
<li><strong>Clustering</strong> shows meaningful segmentation of roles, reinforcing that jobs naturally group into high-skill/high-pay and low-skill/low-pay categories.</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Job seekers looking to maximize salary potential should <strong>pivot toward AI-focused roles</strong>, especially in the Technology sector.</li>
<li>Candidates should consider <strong>upskilling with AI and data-related tools</strong> to stand out in the evolving market.</li>
<li>Non-AI professionals in lower-paying industries should consider <strong>geographic relocation, reskilling, or transitioning industries</strong> to remain competitive.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>